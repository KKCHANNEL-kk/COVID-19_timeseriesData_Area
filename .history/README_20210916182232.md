# COVID-19_timeseriesData_Area——新冠疫情地市级时间序列数据采集
[TOC]
## 1.简介
实验室近期需要采集地市级的疫情数据。目前能找到的大部分数据源是**省级粒度的时间序列数据**或**地市级的实时截面数据**，起初找到了这个项目

**2019新型冠状病毒疫情实时爬虫**<a>https://github.com/BlankerL/DXY-COVID-19-Crawler 

使用了丁香园的数据。但是发现了丁香园数据中的几个问题：
1. 统计口径较混乱，同一地级市在不同的时间指向不同的字段名；
2. 部分省（广东、四川、吉林、甘肃）没有单独统计境外输入数据，境外输入被归于各地级市中，该部分数据无法清洗；
3. 部分数据在新时间中被修正，没有同步修正回旧时间，出现累计确诊数倒减的情况。

受问题2影响，最后还是找新数据源重新采集并清洗一遍数据。本项目使用腾讯新闻api获取并处理新冠疫情地市级时间序列数据，数据所有权为腾讯新闻，脚本及获取数据仅作参考与学习用，对数据质量不做担保。本人无法授权任何个人或团体在科研或商业项目中使用本数据，如有需要，希望您能够联系腾讯新闻并取得许可。如有建议或异常反馈，欢迎提交issue。

腾讯新闻疫情实时追踪页面：<a>https://news.qq.com/zt2020/page/feiyan.htm#/global
## 2.使用说明
下载文件。保证getAreaData.py和covid19_area_timeseries_data.py在同一路径下，运行covid19_area_timeseries_data.py即可

## 3.实现原理
### 数据获取
打开网页后开启浏览器的开发者工具，选中Network查看网页传输的文件，就可以比较顺利地找到腾讯的api，写了一个很简单的请求就抓齐了数据（见getAreaData.py）。

![找到api的位置](mdpics\腾讯新闻疫情数据截图.png)

返回的json中时间序列不齐，只包含卫健委公布实时新闻当天的更新数据，因此在两次时间中的空缺数据需要我自行填补（两次公告之前的数据理论上不变，取时间靠前的数据填补缺失值）

![json截图](mdpics\json截图.png)

api需要的参数是省份province和城市（直辖市的区）city，api的制作使用了一个睿智办法肉身编码。需要注意港澳台只有province没有city参数，所以另开了一个循环单独处理。

![肉身编码小朋友不要学，牺牲我一个就好](mdpics\肉身编码.png)

api请求和json解析使用的基本都是封装好的方法，略。

### 数据清洗
## 4.后续挖坑